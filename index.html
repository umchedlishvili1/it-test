<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <title>Duty Manager Pro - Ultimate Control</title>
    <style>
        :root { --dark: #0f172a; --blue: #0ea5e9; --green: #16a34a; --viber: #7360f2; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; display: flex; height: 100vh; background: var(--bg); overflow: hidden; }
        
        #sidebar { width: 380px; background: var(--dark); color: white; padding: 25px; overflow-y: auto; flex-shrink: 0; border-right: 1px solid rgba(255,255,255,0.1); }
        .box { background: rgba(255,255,255,0.07); padding: 18px; border-radius: 20px; margin-bottom: 20px; border: 1px solid rgba(255,255,255,0.1); }
        h3 { color: var(--blue); font-size: 12px; text-transform: uppercase; margin: 0 0 15px 0; letter-spacing: 2px; font-weight: 800; }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 10px; border-radius: 12px; border: none; font-weight: 700; box-sizing: border-box; font-size: 14px; }
        
        #main { flex-grow: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; align-items: center; }
        #canvas { width: 100%; max-width: 720px; background: white; border-radius: 45px; padding: 35px; box-shadow: 0 30px 60px rgba(15, 23, 42, 0.15); }
        
        .live-banner { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); color: white; padding: 30px; border-radius: 35px; text-align: center; margin-bottom: 25px; border: 1px solid rgba(255,255,255,0.1); }
        .big-date { font-size: 42px; font-weight: 900; color: var(--blue); margin-bottom: 8px; letter-spacing: -1px; }
        .live-name { font-size: 24px; font-weight: 800; margin-bottom: 5px; }
        
        .priority-box { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .p-card { padding: 15px; border-radius: 28px; color: white; text-align: center; min-height: 160px; display: flex; flex-direction: column; justify-content: flex-start; box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        .p-card small { font-weight: 900; text-transform: uppercase; font-size: 10px; letter-spacing: 1px; margin-bottom: 10px; display: block; opacity: 0.9; border-bottom: 1px solid rgba(255,255,255,0.2); padding-bottom: 5px; }
        .p-info { background: rgba(255,255,255,0.15); padding: 10px 5px; border-radius: 18px; margin-bottom: 8px; }
        
        .btn-m { text-decoration: none; padding: 5px 10px; border-radius: 10px; display: inline-flex; align-items: center; justify-content: center; margin: 2px; font-size: 11px; font-weight: 900; transition: 0.2s; border: none; }
        .btn-call { background: var(--green) !important; color: white !important; }
        .btn-viber { background: var(--viber) !important; color: white !important; }
        
        .row { padding: 20px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; transition: 0.3s; }
        .today-row { background: #f0f9ff; border-left: 8px solid var(--blue); border-radius: 0 20px 20px 0; transform: scale(1.02); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        
        .btn-gen { background: var(--blue); color: white; width: 100%; padding: 14px; border: none; border-radius: 15px; font-weight: 800; cursor: pointer; font-size: 14px; }
        .btn-export { background: var(--green); color: white; width: 720px; padding: 20px; border-radius: 25px; border: none; font-weight: 900; cursor: pointer; margin-top: 20px; font-size: 18px; letter-spacing: 1px; box-shadow: 0 10px 20px rgba(22, 163, 74, 0.2); }
        .s-item { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.1); padding: 10px 15px; border-radius: 12px; margin-bottom: 6px; font-size: 13px; font-weight: 600; }
        .del { color: #ff4757; cursor: pointer; font-size: 18px; padding-left: 10px; }
    </style>
</head>
<body>

<div id="sidebar">
    <div class="box">
        <h3>ğŸ“… áƒáƒ”áƒ áƒ˜áƒáƒ“áƒ˜áƒ¡ áƒ›áƒáƒ áƒ—áƒ•áƒ</h3>
        <input type="month" id="workMonth">
        <div style="display:flex; gap:10px;">
            <input type="number" id="rangeStart" placeholder="áƒ“áƒáƒœ" value="1">
            <input type="number" id="rangeEnd" placeholder="áƒ›áƒ“áƒ”" value="31">
        </div>
        <button class="btn-gen" onclick="generateSchedule()">ğŸ”„ áƒ’áƒáƒœáƒ áƒ˜áƒ’áƒ˜áƒ¡ áƒ’áƒ”áƒœáƒ”áƒ áƒ˜áƒ áƒ”áƒ‘áƒ</button>
    </div>

    <div class="box">
        <h3>ğŸ‘¥ áƒ›áƒáƒ áƒ˜áƒ’áƒ” áƒáƒ”áƒ áƒ¡áƒáƒœáƒáƒšáƒ˜</h3>
        <input type="text" id="stName" placeholder="áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ áƒ’áƒ•áƒáƒ áƒ˜">
        <input type="text" id="stPhone" placeholder="áƒ¢áƒ”áƒšáƒ”áƒ¤áƒáƒœáƒ˜">
        <button class="btn-gen" style="background:#6366f1" onclick="addItem('staff')">+ áƒ—áƒáƒœáƒáƒ›áƒ¨áƒ áƒáƒ›áƒšáƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ</button>
        <div id="staffListUI" style="margin-top:15px;"></div>
    </div>

    <div class="box">
        <h3>ğŸ”ï¸ áƒ áƒ”áƒ’áƒ˜áƒáƒœáƒ˜áƒ¡ áƒ£áƒ¤áƒ áƒáƒ¡áƒ”áƒ‘áƒ˜</h3>
        <select id="regType">
            <option value="west">ğŸ”ï¸ áƒ“áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜</option>
            <option value="east">â˜€ï¸ áƒáƒ¦áƒ›áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜</option>
        </select>
        <input type="text" id="regName" placeholder="áƒ¡áƒáƒ®áƒ”áƒšáƒ˜ áƒ’áƒ•áƒáƒ áƒ˜">
        <input type="text" id="regPhone" placeholder="áƒ¢áƒ”áƒšáƒ”áƒ¤áƒáƒœáƒ˜">
        <button class="btn-gen" style="background:var(--east)" onclick="addItem('regional')">+ áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡áƒ›áƒ’áƒ”áƒ‘áƒšáƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ</button>
        <div id="regListUI" style="margin-top:15px;"></div>
    </div>

    <div class="box">
        <h3>ğŸ“ áƒ¥áƒáƒšáƒªáƒ”áƒœáƒ¢áƒ áƒ˜ / áƒ¨áƒ”áƒœáƒ˜áƒ¨áƒ•áƒœáƒ</h3>
        <input type="text" id="ccNum" value="8888" oninput="render()">
        <textarea id="noteTxt" placeholder="áƒ“áƒáƒ¬áƒ”áƒ áƒ”áƒ— áƒ¨áƒ”áƒœáƒ˜áƒ¨áƒ•áƒœáƒ..." oninput="render()"></textarea>
        <input type="color" id="noteClr" value="#0ea5e9" onchange="render()">
    </div>
</div>

<div id="main">
    <div id="canvas">
        <div class="live-banner">
            <div id="liveD" class="big-date">---</div>
            <div id="liveN" class="live-name">- - -</div>
            <a id="liveP" href="#" style="font-size:30px; color:var(--blue); font-weight:900; text-decoration:none; display:block; margin:10px 0;">---</a>
            <div style="display:flex; gap:15px; justify-content:center; margin-top:15px;">
                <a id="liveC" href="#" class="btn-gen" style="background:var(--green); width:130px; text-decoration:none; display:flex; align-items:center; justify-content:center;">ğŸ“ CALL</a>
                <a id="liveV" href="#" class="btn-gen" style="background:var(--viber); width:130px; text-decoration:none; display:flex; align-items:center; justify-content:center;">ğŸ’œ VIBER</a>
            </div>
        </div>

        <div class="priority-box">
            <div id="wBox" class="p-card" style="background:#f59e0b"></div>
            <div id="eBox" class="p-card" style="background:#ea580c"></div>
            <div id="cBox" class="p-card" style="background:#334155; border:2px dashed rgba(255,255,255,0.3)"></div>
        </div>

        <div id="noteBox" style="display:none; padding:20px; border-radius:25px; border-left:8px solid; margin-bottom:25px; background:#f1f5f9; font-weight:800; font-size:16px; color:#1e293b;"></div>
        <div id="scheduleBody"></div>
    </div>
    <button class="btn-export" onclick="exportFinal()">ğŸ“‹ áƒ¡áƒáƒ‘áƒáƒšáƒáƒ HTML-áƒ˜áƒ¡ áƒ™áƒáƒáƒ˜áƒ áƒ”áƒ‘áƒ</button>
</div>

<script>
    let staff = [
        { name: "áƒ’áƒ˜áƒáƒ áƒ’áƒ˜ áƒšáƒáƒ›áƒ˜áƒ«áƒ”", phone: "555558222" },
        { name: "áƒ•áƒáƒ¡áƒ˜áƒš áƒ’áƒáƒ’áƒáƒšáƒáƒ«áƒ”", phone: "557949827" },
        { name: "áƒ¨áƒáƒšáƒ•áƒ áƒ’áƒáƒ’áƒœáƒ˜áƒ«áƒ”", phone: "551770200" },
        { name: "áƒ’áƒ˜áƒáƒ áƒ’áƒ˜ áƒ¢áƒáƒ áƒ§áƒáƒ¨áƒ•áƒ˜áƒšáƒ˜", phone: "577385250" },
        { name: "áƒ’áƒ£áƒ’áƒ áƒ‘áƒáƒšáƒáƒœáƒ©áƒ˜áƒ•áƒáƒ«áƒ”", phone: "577978792" },
        { name: "áƒ’áƒ˜áƒáƒ áƒ’áƒ˜ áƒ‘áƒáƒ­áƒáƒ áƒ˜áƒ¨áƒ•áƒ˜áƒšáƒ˜", phone: "591927831" },
        { name: "áƒ‘áƒ”áƒ¥áƒ áƒ¢áƒáƒšáƒáƒ®áƒáƒ«áƒ”", phone: "551982772" },
        { name: "áƒáƒšáƒ˜áƒ™áƒ áƒ§áƒáƒšáƒ˜áƒ©áƒáƒ•áƒ", phone: "551688899" }
    ];

    let west = [{name: "áƒ–áƒáƒáƒš áƒ’áƒ•áƒ”áƒ¢áƒáƒ«áƒ”", phone: "568230917"}];
    let east = [{name: "áƒ—áƒ”áƒ›áƒ áƒ’áƒ”áƒšáƒáƒ¨áƒ•áƒ˜áƒšáƒ˜", phone: "577698890"}, {name: "áƒ£áƒ©áƒ áƒ›áƒ­áƒ”áƒ“áƒšáƒ˜áƒ¨áƒ•áƒ˜áƒšáƒ˜", phone: "599470033"}];
    let schedule = [];
    const months = ["áƒ˜áƒáƒœáƒ•áƒáƒ áƒ˜", "áƒ—áƒ”áƒ‘áƒ”áƒ áƒ•áƒáƒšáƒ˜", "áƒ›áƒáƒ áƒ¢áƒ˜", "áƒáƒáƒ áƒ˜áƒšáƒ˜", "áƒ›áƒáƒ˜áƒ¡áƒ˜", "áƒ˜áƒ•áƒœáƒ˜áƒ¡áƒ˜", "áƒ˜áƒ•áƒšáƒ˜áƒ¡áƒ˜", "áƒáƒ’áƒ•áƒ˜áƒ¡áƒ¢áƒ", "áƒ¡áƒ”áƒ¥áƒ¢áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜", "áƒáƒ¥áƒ¢áƒáƒ›áƒ‘áƒ”áƒ áƒ˜", "áƒœáƒáƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜", "áƒ“áƒ”áƒ™áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜"];

    window.onload = () => {
        document.getElementById('workMonth').value = new Date().toISOString().slice(0, 7);
        render();
    };

    function addItem(type) {
        if(type === 'staff') {
            const n = document.getElementById('stName').value, p = document.getElementById('stPhone').value;
            if(n && p) { staff.push({name:n, phone:p}); document.getElementById('stName').value=''; document.getElementById('stPhone').value=''; }
        } else {
            const n = document.getElementById('regName').value, p = document.getElementById('regPhone').value, t = document.getElementById('regType').value;
            if(n && p) {
                if(t === 'west') west.push({name:n, phone:p}); else east.push({name:n, phone:p});
                document.getElementById('regName').value=''; document.getElementById('regPhone').value='';
            }
        }
        render();
    }

    function generateSchedule() {
        const mVal = document.getElementById('workMonth').value;
        const start = parseInt(document.getElementById('rangeStart').value), end = parseInt(document.getElementById('rangeEnd').value);
        if(!mVal || staff.length === 0) return;
        schedule = [];
        for(let d = start; d <= end; d++) {
            schedule.push({ day: d, person: staff[(d-start) % staff.length] });
        }
        render();
    }

    function updateDayPerson(idx, name) {
        schedule[idx].person = staff.find(s => s.name === name);
        render();
    }

    function render() {
        document.getElementById('staffListUI').innerHTML = staff.map((s, i) => `<div class="s-item">${s.name} <span class="del" onclick="staff.splice(${i},1);render()">âœ•</span></div>`).join('');
        document.getElementById('regListUI').innerHTML = 
            west.map((s, i) => `<div class="s-item" style="color:#f59e0b">W: ${s.name} <span class="del" onclick="west.splice(${i},1);render()">âœ•</span></div>`).join('') +
            east.map((s, i) => `<div class="s-item" style="color:#ea580c">E: ${s.name} <span class="del" onclick="east.splice(${i},1);render()">âœ•</span></div>`).join('');

        const drawP = (list) => list.map(p => `<div class="p-info"><b>${p.name}</b><span>${p.phone}</span><div style="margin-top:3px;"><a href="tel:${p.phone}" class="btn-m btn-call">ğŸ“ CALL</a><a href="viber://chat?number=%2B995${p.phone.slice(-9)}" class="btn-m btn-viber">ğŸ’œ VIBER</a></div></div>`).join('');
        
        document.getElementById('wBox').innerHTML = `<small>ğŸ”ï¸ áƒ“áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜</small>` + drawP(west);
        document.getElementById('eBox').innerHTML = `<small>â˜€ï¸ áƒáƒ¦áƒ›áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜</small>` + drawP(east);
        document.getElementById('cBox').innerHTML = `<small>ğŸ“ áƒ¥áƒáƒšáƒªáƒ”áƒœáƒ¢áƒ áƒ˜</small><b style="font-size:24px; margin:15px 0; display:block;">${document.getElementById('ccNum').value}</b><span style="font-size:11px; font-weight:800;">09:00 - 18:00</span>`;

        const nBox = document.getElementById('noteBox'), nTxt = document.getElementById('noteTxt').value;
        nBox.style.display = nTxt ? 'block' : 'none'; nBox.innerText = nTxt; nBox.style.borderColor = document.getElementById('noteClr').value;

        const mVal = document.getElementById('workMonth').value;
        if(mVal && schedule.length) {
            const year = parseInt(mVal.split('-')[0]), month = parseInt(mVal.split('-')[1]) - 1;
            const mName = months[month];
            const today = new Date().getDate(), currM = new Date().getMonth() + 1;
            
            document.getElementById('scheduleBody').innerHTML = schedule.map((item, idx) => {
                const dateObj = new Date(year, month, item.day);
                const hours = (dateObj.getDay() === 0 || dateObj.getDay() === 6) ? "06:00 - 06:00" : "18:00 - 06:00";
                let isToday = (item.day === today && (month + 1) === currM);
                
                if(isToday) {
                    document.getElementById('liveD').innerText = `${item.day} ${mName}`;
                    document.getElementById('liveN').innerText = item.person.name;
                    document.getElementById('liveP').innerText = item.person.phone;
                    document.getElementById('liveC').href = "tel:"+item.person.phone;
                    document.getElementById('liveV').href = "viber://chat?number=%2B995"+item.person.phone.slice(-9);
                }

                return `<div class="row ${isToday ? 'today-row' : ''}">
                    <div><b>${item.day} ${mName}</b><br><small style="font-size:11px; color:#64748b; font-weight:800;">${hours}</small></div>
                    <div style="text-align:right">
                        <select style="width:160px; font-size:12px; margin-bottom: 5px;" onchange="updateDayPerson(${idx}, this.value)">
                            ${staff.map(s => `<option value="${s.name}" ${s.name === item.person.name ? 'selected' : ''}>${s.name}</option>`).join('')}
                        </select>
                        <div style="font-size:14px; font-weight:900; color:var(--blue); margin-bottom:5px;">${item.person.phone}</div>
                        <div style="display:flex; gap:5px; justify-content:flex-end;">
                            <a href="tel:${item.person.phone}" class="btn-m btn-call">ğŸ“ CALL</a>
                            <a href="viber://chat?number=%2B995${item.person.phone.slice(-9)}" class="btn-m btn-viber">ğŸ’œ VIBER</a>
                        </div>
                    </div>
                </div>`;
            }).join('');
        }
    }

    function exportFinal() {
        const mVal = document.getElementById('workMonth').value;
        const year = parseInt(mVal.split('-')[0]), month = parseInt(mVal.split('-')[1]) - 1;
        const mName = months[month];
        
        // áƒ¤áƒ£áƒœáƒ¥áƒªáƒ˜áƒ áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡áƒ›áƒ’áƒ”áƒ‘áƒ”áƒšáƒ˜ áƒáƒ˜áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒ‘áƒáƒ áƒáƒ—áƒ”áƒ‘áƒ˜áƒ¡áƒ—áƒ•áƒ˜áƒ¡ áƒ¡áƒáƒ‘áƒáƒšáƒáƒ HTML-áƒ¨áƒ˜
        const getPriorityHTML = (title, list, color) => {
            const items = list.map(p => `
                <div style="background:rgba(255,255,255,0.15); padding:10px; border-radius:18px; margin-bottom:8px;">
                    <b style="font-size:13px; display:block;">${p.name}</b>
                    <span style="font-size:12px; display:block; margin-bottom:5px;">${p.phone}</span>
                    <div style="display:flex; gap:3px; justify-content:center;">
                        <a href="tel:${p.phone}" style="background:#16a34a; color:white; text-decoration:none; padding:4px 8px; border-radius:8px; font-size:10px; font-weight:900;">ğŸ“ CALL</a>
                        <a href="viber://chat?number=%2B995${p.phone.slice(-9)}" style="background:#7360f2; color:white; text-decoration:none; padding:4px 8px; border-radius:8px; font-size:10px; font-weight:900;">ğŸ’œ VIBER</a>
                    </div>
                </div>`).join('');
            return `<div style="background:${color}; padding:15px; border-radius:28px; color:white; text-align:center; min-height:160px;">
                <small style="text-transform:uppercase; font-size:10px; display:block; margin-bottom:10px; border-bottom:1px solid rgba(255,255,255,0.2); padding-bottom:5px;">${title}</small>
                ${items}
            </div>`;
        };

        const finalRows = schedule.map(item => {
            const dateObj = new Date(year, month, item.day);
            const hours = (dateObj.getDay() === 0 || dateObj.getDay() === 6) ? "06:00 - 06:00" : "18:00 - 06:00";
            return `
            <div class="row" style="padding:20px; border-bottom:1px solid #f1f5f9; display:flex; justify-content:space-between; align-items:center;">
                <div><b>${item.day} ${mName}</b><br><small style="color:#666; font-size:11px; font-weight:bold;">${hours}</small></div>
                <div style="text-align:right">
                    <b style="font-size:16px; color:#0f172a;">${item.person.name}</b><br>
                    <span style="color:#0ea5e9; font-weight:900; font-size:14px; display:block; margin:4px 0;">${item.person.phone}</span>
                    <div style="display:flex; gap:5px; justify-content:flex-end;">
                        <a href="tel:${item.person.phone}" style="background:#16a34a; color:white; text-decoration:none; padding:6px 12px; border-radius:10px; font-size:11px; font-weight:900; display:inline-block;">ğŸ“ CALL</a>
                        <a href="viber://chat?number=%2B995${item.person.phone.slice(-9)}" style="background:#7360f2; color:white; text-decoration:none; padding:6px 12px; border-radius:10px; font-size:11px; font-weight:900; display:inline-block;">ğŸ’œ VIBER</a>
                    </div>
                </div>
            </div>`;
        }).join('');

        const fullHTML = `<!DOCTYPE html><html><head><meta charset="UTF-8">
            <style>
                body{font-family:system-ui,-apple-system,sans-serif; background:#f8fafc; padding:20px; display:flex; justify-content:center;}
                #canvas{width:100%; max-width:720px; background:white; border-radius:45px; padding:35px; box-shadow:0 30px 60px rgba(0,0,0,0.1);}
                .live-banner{background:linear-gradient(135deg,#1e293b 0%,#0f172a 100%); color:white; padding:30px; border-radius:35px; text-align:center; margin-bottom:25px;}
                .big-date{font-size:42px; font-weight:900; color:#0ea5e9; margin-bottom:8px;}
                .live-name{font-size:24px; font-weight:800; margin-bottom:5px;}
                .priority-box{display:grid; grid-template-columns:1fr 1fr 1fr; gap:15px; margin-bottom:20px;}
            </style></head>
            <body>
                <div id="canvas">
                    <div class="live-banner">
                        <div class="big-date">${document.getElementById('liveD').innerText}</div>
                        <div class="live-name">${document.getElementById('liveN').innerText}</div>
                        <div style="font-size:30px; color:#0ea5e9; font-weight:900; margin:10px 0;">${document.getElementById('liveP').innerText}</div>
                        <div style="display:flex; gap:15px; justify-content:center; margin-top:15px;">
                            <a href="${document.getElementById('liveC').href}" style="background:#16a34a; color:white; text-decoration:none; padding:12px 25px; border-radius:15px; font-weight:800;">ğŸ“ CALL</a>
                            <a href="${document.getElementById('liveV').href}" style="background:#7360f2; color:white; text-decoration:none; padding:12px 25px; border-radius:15px; font-weight:800;">ğŸ’œ VIBER</a>
                        </div>
                    </div>
                    <div class="priority-box">
                        ${getPriorityHTML('ğŸ”ï¸ áƒ“áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜', west, '#f59e0b')}
                        ${getPriorityHTML('â˜€ï¸ áƒáƒ¦áƒ›áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ—áƒ˜', east, '#ea580c')}
                        <div style="background:#334155; padding:15px; border-radius:28px; color:white; text-align:center; min-height:160px; border:2px dashed rgba(255,255,255,0.3)">
                            <small style="text-transform:uppercase; font-size:10px; display:block; margin-bottom:10px;">ğŸ“ áƒ¥áƒáƒšáƒªáƒ”áƒœáƒ¢áƒ áƒ˜</small>
                            <b style="font-size:24px; margin:15px 0; display:block;">${document.getElementById('ccNum').value}</b>
                            <span style="font-size:11px; font-weight:800;">09:00 - 18:00</span>
                        </div>
                    </div>
                    ${document.getElementById('noteBox').style.display !== 'none' ? `<div style="padding:20px; border-radius:25px; border-left:8px solid ${document.getElementById('noteClr').value}; margin-bottom:25px; background:#f1f5f9; font-weight:800; color:#1e293b;">${document.getElementById('noteTxt').value}</div>` : ''}
                    <div id="scheduleBody">${finalRows}</div>
                </div>
            </body></html>`;

        const el = document.createElement('textarea'); el.value = fullHTML; document.body.appendChild(el); el.select();
        document.execCommand('copy'); document.body.removeChild(el);
        alert("âœ… áƒ¡áƒáƒ‘áƒáƒšáƒáƒ áƒ•áƒ”áƒ áƒ¡áƒ˜áƒ (áƒáƒáƒ¡áƒ£áƒ®áƒ˜áƒ¡áƒ›áƒ’áƒ”áƒ‘áƒšáƒ”áƒ‘áƒ˜áƒ¡ áƒ¦áƒ˜áƒšáƒáƒ™áƒ”áƒ‘áƒ˜áƒ—) áƒ“áƒáƒ™áƒáƒáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ!");
    }
</script>
</body>
</html>
